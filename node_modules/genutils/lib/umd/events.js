var t,i;t=this,i=function(t){function i(t,i){i=i||{},this._head=0,this._tail=0,this._capacity=i.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}i.prototype.peekAt=function(t){var i=t;if(i===(0|i)){var s=this.size();if(!(i>=s||i<-s))return i<0&&(i+=s),i=this._head+i&this._capacityMask,this._list[i]}},i.prototype.get=function(t){return this.peekAt(t)},i.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},i.prototype.peekFront=function(){return this.peek()},i.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(i.prototype,"length",{get:function(){return this.size()}}),i.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},i.prototype.unshift=function(t){if(void 0===t)return this.size();var i=this._list.length;return this._head=this._head-1+i&this._capacityMask,this._list[this._head]=t,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},i.prototype.shift=function(){var t=this._head;if(t!==this._tail){var i=this._list[t];return this._list[t]=void 0,this._head=t+1&this._capacityMask,t<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),i}},i.prototype.push=function(t){if(void 0===t)return this.size();var i=this._tail;return this._list[i]=t,this._tail=i+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},i.prototype.pop=function(){var t=this._tail;if(t!==this._head){var i=this._list.length;this._tail=t-1+i&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&t>1e4&&t<=i>>>2&&this._shrinkArray(),s}},i.prototype.removeOne=function(t){var i=t;if(i===(0|i)&&this._head!==this._tail){var s=this.size(),e=this._list.length;if(!(i>=s||i<-s)){i<0&&(i+=s),i=this._head+i&this._capacityMask;var h,a=this._list[i];if(t<s/2){for(h=t;h>0;h--)this._list[i]=this._list[i=i-1+e&this._capacityMask];this._list[i]=void 0,this._head=this._head+1+e&this._capacityMask}else{for(h=s-1-t;h>0;h--)this._list[i]=this._list[i=i+1+e&this._capacityMask];this._list[i]=void 0,this._tail=this._tail-1+e&this._capacityMask}return a}}},i.prototype.remove=function(t,i){var s,e=t,h=i;if(e===(0|e)&&this._head!==this._tail){var a=this.size(),r=this._list.length;if(!(e>=a||e<-a||i<1)){if(e<0&&(e+=a),1===i||!i)return(s=new Array(1))[0]=this.removeOne(e),s;if(0===e&&e+i>=a)return s=this.toArray(),this.clear(),s;var n;for(e+i>a&&(i=a-e),s=new Array(i),n=0;n<i;n++)s[n]=this._list[this._head+e+n&this._capacityMask];if(e=this._head+e&this._capacityMask,t+i===a){for(this._tail=this._tail-i+r&this._capacityMask,n=i;n>0;n--)this._list[e=e+1+r&this._capacityMask]=void 0;return s}if(0===t){for(this._head=this._head+i+r&this._capacityMask,n=i-1;n>0;n--)this._list[e=e+1+r&this._capacityMask]=void 0;return s}if(e<a/2){for(this._head=this._head+t+i+r&this._capacityMask,n=t;n>0;n--)this.unshift(this._list[e=e-1+r&this._capacityMask]);for(e=this._head-1+r&this._capacityMask;h>0;)this._list[e=e-1+r&this._capacityMask]=void 0,h--;t<0&&(this._tail=e)}else{for(this._tail=e,e=e+i+r&this._capacityMask,n=a-(i+t);n>0;n--)this.push(this._list[e++]);for(e=this._tail;h>0;)this._list[e=e+1+r&this._capacityMask]=void 0,h--}return this._head<2&&this._tail>1e4&&this._tail<=r>>>2&&this._shrinkArray(),s}}},i.prototype.splice=function(t,i){var s=t;if(s===(0|s)){var e=this.size();if(s<0&&(s+=e),!(s>e)){if(arguments.length>2){var h,a,r,n=arguments.length,_=this._list.length,l=2;if(!e||s<e/2){for(a=new Array(s),h=0;h<s;h++)a[h]=this._list[this._head+h&this._capacityMask];for(0===i?(r=[],s>0&&(this._head=this._head+s+_&this._capacityMask)):(r=this.remove(s,i),this._head=this._head+s+_&this._capacityMask);n>l;)this.unshift(arguments[--n]);for(h=s;h>0;h--)this.unshift(a[h-1])}else{var o=(a=new Array(e-(s+i))).length;for(h=0;h<o;h++)a[h]=this._list[this._head+s+i+h&this._capacityMask];for(0===i?(r=[],s!=e&&(this._tail=this._head+s+_&this._capacityMask)):(r=this.remove(s,i),this._tail=this._tail-o+_&this._capacityMask);l<n;)this.push(arguments[l++]);for(h=0;h<o;h++)this.push(a[h])}return r}return this.remove(s,i)}}},i.prototype.clear=function(){this._head=0,this._tail=0},i.prototype.isEmpty=function(){return this._head===this._tail},i.prototype.toArray=function(){return this._copyArray(!1)},i.prototype._fromArray=function(t){for(var i=0;i<t.length;i++)this.push(t[i])},i.prototype._copyArray=function(t){var i,s=[],e=this._list,h=e.length;if(t||this._head>this._tail){for(i=this._head;i<h;i++)s.push(e[i]);for(i=0;i<this._tail;i++)s.push(e[i])}else for(i=this._head;i<this._tail;i++)s.push(e[i]);return s},i.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1},i.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};var s=i;const e=Symbol.for("endTag"),h=t=>t instanceof Object&&"throw"===t[e];t.eventToGenerator=(t=(()=>new s))=>{let i=()=>{},a=null;const r=t(),n=t=>(r.push(t),i());return[async function*(){for(;;){for(;!r.length;)a=new Promise((t=>i=t)),await a,a=null,i=()=>{};const s=r.shift();if((t=s)instanceof Object&&"return"===t[e])return s.value;if(h(s))throw s.value;yield s}var t}(),new class{send(t){return n(t)}end(t){return n({[e]:"return",value:t})}throw(t){return n({[e]:"throw",value:t})}clear(){return r.clear()}}]},t.queue1=()=>{let t,i=!0;return new class{get length(){return i?0:1}push(s){return i=!1,t=s,1}shift(){i=!0;const s=t;return t=void 0,s}clear(){i=!0,t=void 0}}},t.queueNewest=(t=1)=>()=>{const i=new s;return new class{get length(){return i.length}push(s){for(;i.length>=t;)i.shift();return i.push(s)}shift(){return i.shift()}clear(){return i.clear()}}},t.queueOldest=(t=1)=>()=>{const i=new s;return new class{get length(){return i.length}push(s){return i.length<t?i.push(s):i.length}shift(){return i.shift()}clear(){return i.clear()}}},t.queueSticky=()=>{let t,i=!0;return new class{get length(){return i?0:1}push(s){return i=!1,t=s,1}shift(){return t}clear(){i=!0,t=void 0}}},t.queueUnique=t=>{const i=(t,i)=>()=>{const s=new Map;let e=null;return new class{get length(){return s.size}push(e){const h=i(e);return t?(s.delete(h),s.set(h,e)):s.has(h)||s.set(h,e),s.size}shift(){e||(e=s.values());const t=e.next();if(!t.done)return t.value;e=null}clear(){return s.clear()}}};return void 0===t?i(!1,(t=>t)):i(!!t.newest,t.keyFn||(t=>t))},t.queueUpdateShallow=(t={})=>()=>{const i={...t};let s={},e=!1;return new class{get length(){return e?1:0}push(t){const h=h=>Object.keys(h).forEach((h=>{i[h]!==t[h]&&(s[h]=t[h],e=!0)}));return h(i),h(t),1}shift(){try{return s}finally{Object.assign(i,s),this.clear()}}clear(){s={},e=!1}}},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).events={});
//# sourceMappingURL=events.js.map
