var t,e;t=this,e=function(t){const e=t=>"function"==typeof t,r=t=>t&&(p(t)||_(t)),i=t=>t&&(d(t)||w(t)||_(t)),n=t=>t&&e(t.next)&&e(t.return)&&e(t.throw)&&e(t[Symbol.iterator]),a=t=>t&&e(t.next)&&e(t.return)&&e(t.throw)&&e(t[Symbol.asyncIterator]);function s(t){if(n(t))return t;if(p(t)){const r=t;function*e(){for(;;){const t=r.next();if(t.done)return t.value;yield t.value}}return e()}if(_(t))return s(t[Symbol.iterator]());throw new Error(`Not iterable: ${t}`)}function o(t){if(a(t))return t;if(d(t)){const r=t;async function*e(){for(;;){const t=await r.next();if(t.done)return t.value;yield t.value}}return e()}if(w(t))return o(t[Symbol.asyncIterator]());if(_(t))return o(t[Symbol.iterator]());throw new Error(`Not iterable: ${t}`)}function l(t){if(n(t))return t;if(p(t))return t;if(_(t))return t[Symbol.iterator]();throw new Error(`Not iterable: ${t}`)}function h(t){if(a(t))return t;if(w(t))return t[Symbol.asyncIterator]();if(_(t))return c(l(t));throw new Error(`Not iterable: ${t}`)}const c=t=>{const e=t;let r;return r=async function*(){let i,n=!1;try{for(;;){const t=await Promise.resolve(e.next());if(t.done)return n=!0,t.value;try{i=yield t.value}catch(t){throw await(e.throw?.(t)),t}}}finally{n||await(t.return?.(r.returning))}}()};function u(t){return _(t)?t:{[Symbol.iterator]:()=>t}}function f(t){return w(t)?t:_(t)?y(t):{[Symbol.asyncIterator]:()=>t}}async function*y(t){const e=t[Symbol.iterator]();let r;for(;;){const t=await e.next(r);if(t.done)return t.value;r=yield t.value}}const p=t=>t&&"function"==typeof t.next,d=t=>t&&"function"==typeof t.next,_=t=>t&&"function"==typeof t[Symbol.iterator],w=t=>t&&"function"==typeof t[Symbol.asyncIterator],v=(t,e)=>(...r)=>{try{return t(...r)}catch(t){return e?.(t)}};class m{returning;[Symbol.toStringTag];asArray(){return this._impl.asArray(this)}limit(t){return this._impl.limit(t,this)}forEach(t,e){this._impl.forEach(t,e,this)}map(t,e){return this._impl.map(t,e,this)}filter(t,e){return this._impl.filter(t,e,this)}flat(t=1){return this._impl.flat(t,this)}flatMap(t,e=1){return this._impl.flatMap(t,e,this)}slice(t=0,e=Number.POSITIVE_INFINITY){return this._impl.slice(t,e,this)}concat(...t){return this._impl.concat(this,...t)}reduce(t,e){return this._impl.reduce(t,e,this)}some(t,e){return this._impl.some(t,e,this)}every(t,e){return this._impl.every(t,e,this)}repeatLast(t=Number.POSITIVE_INFINITY){return this._impl.repeatLast(this,t)}repeat(t,e=Number.POSITIVE_INFINITY){const r=this._impl.repeat(t,e);return this._impl.concat(this,r)}zip(...t){return this._impl.zip(this,...t)}join(t){return this._impl.join(this,t)}sort(t){return this._impl.sort(t)(this)}}class g extends m{[Symbol.toStringTag]}const b=new class{of(...t){return this.enhance(t)}asArray(t){return[...u(t)]}limit(t,e){let r;function*i(e){let i,n=!1;try{for(let r=0;r<t;r++){const t=e.next(i);if(t.done)return t.value;try{i=yield t.value}catch(t){e.throw?.(t)}}n=!0;const a=new RangeError(`Generator produced excessive values > ${t}.`);throw e.throw?.(a),a}finally{n||e.return?.(r?.returning)}}return e?r=this.enhance(i(l(e))):t=>this.enhance(i(l(t)))}forEach(t,e,i){const n=(t,e,r)=>{const i=l(r);let n=0;for(;;){const r=i.next();if(r.done)return;t.call(e,r.value,n++)}};return i?n(t,e,i):r(e)?n(t,void 0,e):(r,i)=>n(t,i??e,r)}map(t,e,i){const n=(e,r)=>{const i=s(r);let n;return n=this.enhance(function*(){let r,a=0;for(;;)for(;;)try{for(;;){const n=i.next(r);if(n.done)return n.value;const s=t.call(e,n.value,a++);try{r=yield s}catch(t){i.throw(t)}}}finally{if(!i.return(n?.returning).done)break}}())};return i?n(e,i):r(e)?n(void 0,e):(t,r)=>n(r??e,t)}filter(t,e,i){const n=(e,r)=>{const i=s(r);let n;return n=this.enhance(function*(t){let r,a=0;for(;;)for(;;)try{for(;;){const n=i.next(r);if(n.done)return n.value;if(t.call(e,n.value,a++))try{r=yield n.value}catch(t){i.throw(t)}}}finally{const t=i.return?.(n?.returning);if(!t?.done)break}}(t))};return i?n(e,i):r(e)?n(void 0,e):(t,r)=>n(r??e,t)}flat(t,e){const i=(t,e)=>{let r;const i=new Set;return n(e)&&i.add(e),r=this.enhance(function*t(e,a){let s;for(;;)for(;;)try{for(;;){const r=e.next(s);if(r.done)return r.value;const o=r.value;n(o)&&i.add(o);try{a>0&&p(o)?yield*t(o,a-1):a>0&&_(o)?yield*t(l(o),a-1):s=yield r.value}catch(t){e.throw?.(t)}}}finally{const t=e.return?.(r?.returning);if(n(e)&&i.delete(e),t&&!t.done)break;for(const t of i)t.return(r?.returning)}}(l(e),t))};if("number"==typeof t){if(e){if(r(e))return i(t,e);throw new TypeError(`Invalid Genable: ${e}`)}return e=>i(t,e)}if(r(t))return i(e??1,t);throw new TypeError("Illegal arguments to flat()")}flatMap(t,e,i){const n=(e,r)=>{let i,n=0;return i=this.enhance(function*e(r,a){let o;for(;;)for(;;)try{for(;;){const i=r.next(o);if(i.done)return i.value;const h=t(i.value,n++);try{p(h)?a>1?yield*e(h,a-1):1===a?yield*s(h):yield h:_(h)?a>1?yield*e(l(h),a-1):1===a?yield*s(h):yield h:o=yield h}catch(t){r.throw?.(t)}}}finally{const t=r.return?.(i?.returning);if(t&&!t.done)break}}(l(r),e))};return r(i)?n(e??1,i):r(e)?n(1,e):(t,r)=>n(e??r??1,t)}slice(t,e,r){const i=r=>{const i=l(r);return this.enhance(function*(t,e){for(let e=0;e<t;e++){const t=i.next();if(t.done)return t.value}if(e===Number.POSITIVE_INFINITY)yield*u(i);else{let r;for(;;)try{for(let n=t;n<e;n++){const t=i.next(r);if(t.done)return t.value;try{r=yield t.value}catch(t){const e=i.throw?.(t);if(e){if(e.done)return e.value;r=yield e.value}}}}finally{const t=i.return?.();if(t&&!t.done)break}}}(t,e))};return r?i(r):i}concat(...t){let e;return e=this.enhance(function*(){let r=0;try{for(;r<t.length;r++)yield*u(t[r])}finally{for(;r<t.length;r++){const i=t[r];n(i)&&i.return(e?.returning)}}}())}reduce(t,e,i){const n=(e,r)=>{let i=e;if(void 0===i){const t=r.next();if(t.done)throw new TypeError("No initial value in reduce");i=t.value}for(;;){const e=r.next();if(e.done)return i;i=t(i,e.value)}};return r(i)?n(e,l(i)):r(e)?n(void 0,l(e)):(t,r)=>n(r??e,l(t))}some(t,e,i){const n=(e,r)=>{let i=0;for(;;){const n=r.next();if(n.done)return!1;if(t.call(e,n.value,i++))return!0}};return r(i)?n(e,l(i)):r(e)?n(void 0,l(e)):(t,r)=>n(r??e,l(t))}every(t,e,i){const n=(e,r)=>{let i=0;for(;;){const n=r.next();if(n.done)return!0;if(!t.call(e,n.value,i++))return!1}};if(r(i))return n(e,l(i));if(r(i))return(t,r)=>n(r??e,l(t));throw new Error(`Invalid argument to every: ${i??e}`)}repeatLast(t,e=Number.POSITIVE_INFINITY){const r=l(t);let i,n;return n=this.enhance(function*(){try{let t;for(;;){const e=r.next(i);if(e.done)break;try{i=yield t=e.value}catch(e){const i=r.throw?.(e);if(i){if(i.done)break;yield t=i.value}}}for(let r=0;r<e;r++)yield t}finally{r.return?.(n?.returning)}}())}repeat(t,e=Number.POSITIVE_INFINITY){return this.enhance(function*(){for(let r=0;r<e;r++)yield t}())}zip(...t){if(0===t.length)return this.enhance([]);const e=t.map(l);let r,i=!1;return r=this.enhance(function*(){try{for(;;){let r=[];for(const t of e){const e=t.next();if(e.done)return i=!0,e.value;r.push(e.value)}try{yield r}catch(e){for(const r of t)try{r.throw?.(e)}catch{}throw e}}}finally{if(!i)for(const e of t)try{e.return?.(r?.returning)}catch{}}}())}join(t,e){return"string"==typeof t?(e=t,t=>this.join(t,e)):[...u(t)].join(e)}merge(...t){let e,r=t.map(l);return e=this.enhance(function*(t){let r,i=!1,n=!0;try{for(;n;){n=!1;for(let e=0;e<t.length;e++){const i=t[e];if(i){const a=i.next(r);if(a.done)t[e]=null;else{n=!0;try{r=yield a.value}catch(e){t.forEach(v((t=>t?.throw?.(e))))}}}}}i=!0}finally{i||t.forEach(v((t=>t?.return?.(e?.returning))))}return e?.returning}(r))}sort(t){return(...e)=>this.merge(...e).asArray().sort(t)}enhance(t){const e=s(t),r=Object.getPrototypeOf(e),i=Object.create(g.prototype);return i.return=t=>(e.returning=t,r.return.call(e,t)),i[Symbol.iterator]=()=>e,Object.setPrototypeOf(e,g.prototype),e}},I=Object.getPrototypeOf(function*(){}());Object.setPrototypeOf(g.prototype,(t=>{const e=Object.create(t);return(t=>{for(const r of Reflect.ownKeys(t))"constructor"!==r&&(e[r]=t[r])})(m.prototype),e})(I)),Object.defineProperty(g.prototype,"_impl",{value:b,writable:!1,enumerable:!1,configurable:!1});const x=new class{of(...t){return this.enhance(t)}async asArray(t){const e=h(t),r=[];for(;;){const t=await e.next();if(t.done)return r;r.push(t.value)}}limit(t,e){let r;async function*i(e){let i,n=!1;try{for(let r=0;r<t;r++){const t=await e.next(i);if(t.done)return t.value;try{i=yield t.value}catch(t){await(e.throw?.(t))}}n=!0;const a=new RangeError(`Generator produced excessive values > ${t}.`);throw await(e.throw?.(a)),a}finally{n||await(e.return?.(r?.returning))}}return e?r=this.enhance(i(h(e))):t=>this.enhance(i(h(t)))}forEach(t,e,r){const n=async(t,e,r)=>{const i=h(r);let n=0;for(;;){const r=await i.next();if(r.done)return;await t.call(e,r.value,n++)}};return r?n(t,e,r):i(e)?n(t,void 0,e):(r,i)=>n(t,i??e,r)}map(t,e,r){const n=(e,r)=>{const i=o(r);let n;return n=this.enhance(async function*(){let r,a=0;for(;;)for(;;)try{for(;;){const n=await i.next(r);if(n.done)return n.value;const s=await t.call(e,await n.value,a++);try{r=yield s}catch(t){await i.throw(t)}}}finally{if(!(await i.return(n?.returning)).done)break}}())};return r?n(e,r):i(e)?n(void 0,e):(t,r)=>n(r??e,t)}filter(t,e,r){const n=(e,r)=>{const i=o(r);let n;return n=this.enhance(async function*(t){let r,a=0;for(;;)for(;;)try{for(;;){const n=await i.next(r);if(n.done)return n.value;if(await t.call(e,n.value,a++))try{r=yield n.value}catch(t){await i.throw(t)}}}finally{if(!(await(i.return?.(n?.returning)))?.done)break}}(t))};return r?n(e,r):i(e)?n(void 0,e):(t,r)=>n(r??e,t)}flat(t,e){const r=(t,e)=>{let r;const i=new Set;return a(e)&&i.add(e),r=this.enhance(async function*t(e,n){let s;for(;;)for(;;)try{for(;;){const r=await e.next(s);if(r.done)return r.value;const o=r.value;a(o)&&i.add(o);try{n>0&&d(o)?yield*t(o,n-1):n>0&&(w(o)||_(o))?yield*t(h(o),n-1):s=yield r.value}catch(t){await(e.throw?.(t))}}}finally{const t=await(e.return?.(r?.returning));if(a(e)&&i.delete(e),t&&!t.done)break;for(const t of i)await t.return(r?.returning)}}(h(e),t))};if("number"==typeof t){if(e){if(i(e))return r(t,e);throw new TypeError(`Invalid Genable: ${e}`)}return e=>r(t,e)}if(i(t))return r(e??1,t);throw new TypeError("Illegal arguments to flat()")}flatMap(t,e,r){const n=(e,r)=>{let i,n=0;return i=this.enhance(async function*e(r,a){let s;for(;;)for(;;)try{for(;;){const i=await r.next(s);if(i.done)return i.value;const l=await t(i.value,n++);try{if(d(l))if(a>1)yield*e(l,a-1);else if(1===a){const t=h(l);yield*o(t)}else yield l;else w(l)||_(l)?a>1?yield*e(h(l),a-1):1===a?yield*o(l):yield l:s=yield l}catch(t){await(r.throw?.(t))}}}finally{const t=await(r.return?.(i?.returning));if(t&&!t.done)break}}(h(r),e))};return i(r)?n(e??1,r):i(e)?n(1,e):(t,r)=>n(e??r??1,t)}slice(t,e,r){const i=r=>{const i=h(r);return this.enhance(async function*(t,e){for(let e=0;e<t;e++){const t=await i.next();if(t.done)return t.value}if(e===Number.POSITIVE_INFINITY)yield*f(i);else{let r;for(;;)try{for(let n=t;n<e;n++){const t=await i.next(r);if(t.done)return t.value;try{r=yield t.value}catch(t){const e=await(i.throw?.(t));if(e){if(e.done)return e.value;r=yield e.value}}}}finally{const t=await(i.return?.());if(t&&!t.done)break}}}(t,e))};return r?i(r):i}concat(...t){let e;return e=this.enhance(async function*(){let r=0;try{for(;r<t.length;r++){const e=f(t[r]);yield*e}}finally{for(;r<t.length;r++){const i=t[r];a(i)&&await i.return(e?.returning)}}}())}reduce(t,e,r){const n=async(e,r)=>{let i=await e;if(void 0===i){const t=await r.next();if(t.done)throw new TypeError("No initial value in reduce");i=t.value}for(;;){const e=await r.next();if(e.done)return i;i=await t(i,e.value)}};return i(r)?n(e,h(r)):i(e)?n(void 0,h(e)):(t,r)=>n(r??e,h(t))}some(t,e,r){const n=async(e,r)=>{let i=0;for(;;){const n=await r.next();if(n.done)return!1;if(t.call(e,n.value,i++))return!0}};if(i(r))return n(e,h(r));if(i(r))return(t,r)=>n(r??e,h(t));throw new Error(`Invalid argument to some: ${r??e}`)}every(t,e,n){const a=async(e,r)=>{let i=0;for(;;){const n=await r.next();if(n.done)return!0;if(!t.call(e,n.value,i++))return!1}};if(i(n))return a(e,h(n));if(r(n))return(t,r)=>a(r??e,h(t));throw new Error(`Invalid argument to every: ${n??e}`)}repeatLast(t,e=Number.POSITIVE_INFINITY){const r=h(t);let i,n;return n=this.enhance(async function*(){try{let t;for(;;){const e=await r.next(i);if(e.done)break;try{i=yield t=e.value}catch(e){const i=await(r.throw?.(e));if(i){if(i.done)break;yield t=i.value}}}for(let r=0;r<e;r++)yield await t}finally{await(r.return?.(n?.returning))}}())}repeat(t,e=Number.POSITIVE_INFINITY){return this.enhance(async function*(){for(let r=0;r<e;r++)yield await t}())}zip(...t){if(0===t.length)return this.enhance([]);const e=t.map(h);let r,i=!1;return r=this.enhance(async function*(){try{for(;;){let r=[];for(const t of e){const e=await t.next();if(e.done)return i=!0,e.value;r.push(e.value)}try{yield r}catch(e){for(const r of t)try{await(r.throw?.(e))}catch{}throw e}}}finally{if(!i)for(const e of t)try{await(e.return?.(r?.returning))}catch{}}}())}join(t,e){return"string"==typeof t?(e=t,t=>this.join(t,e)):Promise.resolve(this.enhance(t).asArray()).then((t=>t.join(e)))}merge(...t){let e,r;const i=new Promise((t=>r=t));let n,a=t.length;const s=new Promise((()=>null));let o=[];return n=[...t.map((async(t,e)=>{const i=h(t);o[e]=i;const l=async t=>()=>{if(t.done)return n[e]=s,--a>0?null:(r(t),t);{const r=i.next().then(l);return n[e]=r,t}};return await i.next().then(l)})),i],e=x.enhance(async function*(){try{let r;for(;a;){const t=[];n.forEach((e=>t.push(e)));const e=await await Promise.race(t);if("function"==typeof e){let t=e();if(t){if(t.done)return t.value;r=yield t.value}}else if(e&&e.done)return e.value}}finally{if(a)for(let r=0;r<t.length;r++)(null===n[r]?null:o[r])?.return?.(e?.returning)}}())}sort(t){return async(...e)=>(await this.merge(...e).asArray()).sort(t)}enhance(t){const e=o(t),r=Object.getPrototypeOf(e),i=Object.assign(Object.create(k.prototype),r);return i.return=t=>(e.returning=t,r.return.call(e,t)),i[Symbol.asyncIterator]=()=>e,Object.setPrototypeOf(e,i),e}};class k extends m{}const E=Object.getPrototypeOf(async function*(){}());Object.setPrototypeOf(k.prototype,(t=>{const e=Object.create(t);return(t=>{for(const r of Reflect.ownKeys(t))"constructor"!==r&&(e[r]=t[r])})(m.prototype),e})(E)),Object.defineProperty(k.prototype,"_impl",{value:x,writable:!1,enumerable:!1,configurable:!1});const A=b,S=x;function M(t,e){e=e||{},this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}M.prototype.peekAt=function(t){var e=t;if(e===(0|e)){var r=this.size();if(!(e>=r||e<-r))return e<0&&(e+=r),e=this._head+e&this._capacityMask,this._list[e]}},M.prototype.get=function(t){return this.peekAt(t)},M.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},M.prototype.peekFront=function(){return this.peek()},M.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(M.prototype,"length",{get:function(){return this.size()}}),M.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},M.prototype.unshift=function(t){if(void 0===t)return this.size();var e=this._list.length;return this._head=this._head-1+e&this._capacityMask,this._list[this._head]=t,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},M.prototype.shift=function(){var t=this._head;if(t!==this._tail){var e=this._list[t];return this._list[t]=void 0,this._head=t+1&this._capacityMask,t<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),e}},M.prototype.push=function(t){if(void 0===t)return this.size();var e=this._tail;return this._list[e]=t,this._tail=e+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},M.prototype.pop=function(){var t=this._tail;if(t!==this._head){var e=this._list.length;this._tail=t-1+e&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&t>1e4&&t<=e>>>2&&this._shrinkArray(),r}},M.prototype.removeOne=function(t){var e=t;if(e===(0|e)&&this._head!==this._tail){var r=this.size(),i=this._list.length;if(!(e>=r||e<-r)){e<0&&(e+=r),e=this._head+e&this._capacityMask;var n,a=this._list[e];if(t<r/2){for(n=t;n>0;n--)this._list[e]=this._list[e=e-1+i&this._capacityMask];this._list[e]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(n=r-1-t;n>0;n--)this._list[e]=this._list[e=e+1+i&this._capacityMask];this._list[e]=void 0,this._tail=this._tail-1+i&this._capacityMask}return a}}},M.prototype.remove=function(t,e){var r,i=t,n=e;if(i===(0|i)&&this._head!==this._tail){var a=this.size(),s=this._list.length;if(!(i>=a||i<-a||e<1)){if(i<0&&(i+=a),1===e||!e)return(r=new Array(1))[0]=this.removeOne(i),r;if(0===i&&i+e>=a)return r=this.toArray(),this.clear(),r;var o;for(i+e>a&&(e=a-i),r=new Array(e),o=0;o<e;o++)r[o]=this._list[this._head+i+o&this._capacityMask];if(i=this._head+i&this._capacityMask,t+e===a){for(this._tail=this._tail-e+s&this._capacityMask,o=e;o>0;o--)this._list[i=i+1+s&this._capacityMask]=void 0;return r}if(0===t){for(this._head=this._head+e+s&this._capacityMask,o=e-1;o>0;o--)this._list[i=i+1+s&this._capacityMask]=void 0;return r}if(i<a/2){for(this._head=this._head+t+e+s&this._capacityMask,o=t;o>0;o--)this.unshift(this._list[i=i-1+s&this._capacityMask]);for(i=this._head-1+s&this._capacityMask;n>0;)this._list[i=i-1+s&this._capacityMask]=void 0,n--;t<0&&(this._tail=i)}else{for(this._tail=i,i=i+e+s&this._capacityMask,o=a-(e+t);o>0;o--)this.push(this._list[i++]);for(i=this._tail;n>0;)this._list[i=i+1+s&this._capacityMask]=void 0,n--}return this._head<2&&this._tail>1e4&&this._tail<=s>>>2&&this._shrinkArray(),r}}},M.prototype.splice=function(t,e){var r=t;if(r===(0|r)){var i=this.size();if(r<0&&(r+=i),!(r>i)){if(arguments.length>2){var n,a,s,o=arguments.length,l=this._list.length,h=2;if(!i||r<i/2){for(a=new Array(r),n=0;n<r;n++)a[n]=this._list[this._head+n&this._capacityMask];for(0===e?(s=[],r>0&&(this._head=this._head+r+l&this._capacityMask)):(s=this.remove(r,e),this._head=this._head+r+l&this._capacityMask);o>h;)this.unshift(arguments[--o]);for(n=r;n>0;n--)this.unshift(a[n-1])}else{var c=(a=new Array(i-(r+e))).length;for(n=0;n<c;n++)a[n]=this._list[this._head+r+e+n&this._capacityMask];for(0===e?(s=[],r!=i&&(this._tail=this._head+r+l&this._capacityMask)):(s=this.remove(r,e),this._tail=this._tail-c+l&this._capacityMask);h<o;)this.push(arguments[h++]);for(n=0;n<c;n++)this.push(a[n])}return s}return this.remove(r,e)}}},M.prototype.clear=function(){this._head=0,this._tail=0},M.prototype.isEmpty=function(){return this._head===this._tail},M.prototype.toArray=function(){return this._copyArray(!1)},M.prototype._fromArray=function(t){for(var e=0;e<t.length;e++)this.push(t[e])},M.prototype._copyArray=function(t){var e,r=[],i=this._list,n=i.length;if(t||this._head>this._tail){for(e=this._head;e<n;e++)r.push(i[e]);for(e=0;e<this._tail;e++)r.push(i[e])}else for(e=this._head;e<this._tail;e++)r.push(i[e]);return r},M.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1},M.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};var N=M;const T=Symbol.for("endTag"),O=t=>t instanceof Object&&"throw"===t[T];class j extends Promise{#fn;#delay;#accept;#reject;#result;#error;static[Symbol.toStringTag]="Future";static[Symbol.species]=Promise;constructor(t,e){let r,i;super(((t,e)=>{r=t,i=e})),this.#accept=r,this.#reject=i,this.#fn=t,this.#delay=!!e}eval(t,e){if(!this.#fn){if(this.#error)throw this.#error;return this.#result}try{return this.#result=this.#fn(),this.#accept?.(this.#result),this.#result}catch(t){throw this.#error=t,this.#reject?.(t),t}finally{this.#fn=void 0,this.#accept=void 0,this.#reject=void 0,(t||e)&&super.then(t,e)}}then(t,e){if(this.#fn&&!this.#delay&&(t||e))try{this.eval()}catch(t){}return t||e?super.then(t,e):this}}t.Async=S,t.AsyncMixin=function(t){class e extends t{#tag=void 0;constructor(...t){super(...t)}#iter(){return x.enhance(this[Symbol.asyncIterator]())}asArray(){return this.#iter().asArray()}limit(t){return this.#iter().limit(t)}forEach(t,e){return this.#iter().forEach(t,e)}map(t,e){return this.#iter().map(t,e)}filter(t,e){return this.#iter().filter(t,e)}flat(t=1){return this.#iter().flat(t)}flatMap(t,e=1){return this.#iter().flatMap(t,e)}slice(t=0,e=Number.MAX_SAFE_INTEGER){return this.#iter().slice(t,e)}concat(...t){return this.#iter().concat(...t)}reduce(t,e){return this.#iter().reduce(t,e)}some(t,e){return this.#iter().some(t,e)}every(t,e){return this.#iter().every(t,e)}repeatLast(t=Number.MAX_SAFE_INTEGER){return this.#iter().repeatLast(t)}repeat(t,e=Number.MAX_SAFE_INTEGER){return this.#iter().repeat(t,e)}join(t=""){return this.#iter().join(t)}sort(t){return this.#iter().sort(t)}get[Symbol.toStringTag](){try{return this.#tag??(this.#tag=`SyncMixin(${t.name})`)}catch{return`SyncMixin(${t.name}).prototype`}}}return e},t.Future=j,t.Sync=A,t.SyncMixin=function(t){class e extends t{#tag=void 0;constructor(...t){super(...t)}#iter(){return b.enhance(this[Symbol.iterator]())}asArray(){return this.#iter().asArray()}limit(t){return this.#iter().limit(t)}forEach(t,e){return this.#iter().forEach(t,e)}map(t,e){return this.#iter().map(t,e)}filter(t,e){return this.#iter().filter(t,e)}flat(t=1){return this.#iter().flat(t)}flatMap(t,e=1){return this.#iter().flatMap(t,e)}slice(t=0,e=Number.MAX_SAFE_INTEGER){return this.#iter().slice(t,e)}concat(...t){return this.#iter().concat(...t)}reduce(t,e){return this.#iter().reduce(t,e)}some(t,e){return this.#iter().some(t,e)}every(t,e){return this.#iter().every(t,e)}repeatLast(t=Number.MAX_SAFE_INTEGER){return this.#iter().repeatLast(t)}repeat(t,e=Number.MAX_SAFE_INTEGER){return this.#iter().repeat(t,e)}join(t=""){return this.#iter().join(t)}sort(t){return this.#iter().sort(t)}get[Symbol.toStringTag](){try{return this.#tag??(this.#tag=`SyncMixin(${t.name})`)}catch{return`SyncMixin(${t.name}).prototype`}}}return e},t.delay=(t,e)=>new Promise((r=>setTimeout((()=>r(e)),t))),t.doCatch=v,t.eventToGenerator=(t=(()=>new N))=>{let e=()=>{},r=null;const i=t(),n=t=>(i.push(t),e());return[async function*(){for(;;){for(;!i.length;)r=new Promise((t=>e=t)),await r,r=null,e=()=>{};const n=i.shift();if((t=n)instanceof Object&&"return"===t[T])return n.value;if(O(n))throw n.value;yield n}var t}(),new class{send(t){return n(t)}end(t){return n({[T]:"return",value:t})}throw(t){return n({[T]:"throw",value:t})}clear(){return i.clear()}}]},t.isAsyncGenable=i,t.isAsyncGenerator=a,t.isAsyncIterable=w,t.isAsyncIterableIterator=t=>d(t)&&w(t),t.isAsyncIterator=d,t.isGenable=r,t.isGenerator=n,t.isIterable=_,t.isIterableIterator=t=>p(t)&&_(t),t.isIterator=p,t.queue1=()=>{let t,e=!0;return new class{get length(){return e?0:1}push(r){return e=!1,t=r,1}shift(){e=!0;const r=t;return t=void 0,r}clear(){e=!0,t=void 0}}},t.queueNewest=(t=1)=>()=>{const e=new N;return new class{get length(){return e.length}push(r){for(;e.length>=t;)e.shift();return e.push(r)}shift(){return e.shift()}clear(){return e.clear()}}},t.queueOldest=(t=1)=>()=>{const e=new N;return new class{get length(){return e.length}push(r){return e.length<t?e.push(r):e.length}shift(){return e.shift()}clear(){return e.clear()}}},t.queueSticky=()=>{let t,e=!0;return new class{get length(){return e?0:1}push(r){return e=!1,t=r,1}shift(){return t}clear(){e=!0,t=void 0}}},t.queueUnique=t=>{const e=(t,e)=>()=>{const r=new Map;let i=null;return new class{get length(){return r.size}push(i){const n=e(i);return t?(r.delete(n),r.set(n,i)):r.has(n)||r.set(n,i),r.size}shift(){i||(i=r.values());const t=i.next();if(!t.done)return t.value;i=null}clear(){return r.clear()}}};return void 0===t?e(!1,(t=>t)):e(!!t.newest,t.keyFn||(t=>t))},t.queueUpdateShallow=(t={})=>()=>{const e={...t};let r={},i=!1;return new class{get length(){return i?1:0}push(t){const n=n=>Object.keys(n).forEach((n=>{e[n]!==t[n]&&(r[n]=t[n],i=!0)}));return n(e),n(t),1}shift(){try{return r}finally{Object.assign(e,r),this.clear()}}clear(){r={},i=!1}}},t.range=(t=0,e=Number.MAX_SAFE_INTEGER,r=1)=>b.enhance(function*(t=0,e=Number.MAX_SAFE_INTEGER,r=1){let i=t;if(r>0)for(;i<e;)yield i,i+=r;else{if(!(r<0))throw new Error("Step must not be zero.");for(;i>e;)yield i,i+=r}}(t,e,r)),t.toAsyncGenerator=o,t.toAsyncIterable=f,t.toAsyncIterableIterator=function(t){if(w(t)&&d(t))return t;if(w(t)){let e;const r=()=>e??(e=t[Symbol.asyncIterator]()),i={[Symbol.asyncIterator]:()=>i,next:()=>r().next(),return:r().return&&(t=>r().return(t)),throw:r().throw&&(t=>r().throw(t))};return i}if(_(t))return y(t);if(d(t)){const e={[Symbol.asyncIterator]:()=>e,next:e=>t.next(e),return:t.return&&(e=>t.return(e)),throw:t.throw&&(e=>t.throw(e))};return e}throw new Error(`Not iterator nor iterable: ${t}`)},t.toAsyncIterator=h,t.toGenerator=s,t.toIterable=u,t.toIterableIterator=function(t){if(_(t)&&p(t))return t;if(_(t)){let e;const r=()=>e??(e=t[Symbol.iterator]()),i={[Symbol.iterator]:()=>i,next:t=>r().next(t),return:r().return&&(t=>r().return(t)),throw:r().throw&&(t=>r().throw(t))};return i}if(p(t)){const e={[Symbol.iterator]:()=>e,next:e=>t.next(e),return:t.return&&(e=>t.return(e)),throw:t.throw&&(e=>t.throw(e))};return e}throw new Error(`Not iterator nor iterable: ${t}`)},t.toIterator=l,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).genutils={});
//# sourceMappingURL=index.js.map
